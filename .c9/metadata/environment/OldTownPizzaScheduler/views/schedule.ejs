{"changed":true,"filter":false,"title":"schedule.ejs","tooltip":"/OldTownPizzaScheduler/views/schedule.ejs","value":"<% include ./partials/headIsUser%>\n\n  <!--dropdown menu  -->\n  <div class=\"dropdown hide hidden-menu\">\n    <div class=\"dropdown-menu drop-menu-div\">\n      <a class=\"dropdown-item\" onclick=\"addRowAbove()\">Add Row Above</a>\n      <a class=\"dropdown-item\" onclick=\"addRowBelow()\">Add Row Below</a>\n      <a class=\"dropdown-item\" onclick=\"removeRow()\">Remove Row</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnRight()\">Add Column Right</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnLeft()\">Add Column Left</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnEnd()\">Add Column to End</a>\n      <a class=\"dropdown-item\" onclick=\"removeColumn()\">Remove Column</a>\n    </div>\n  </div>\n\n\n\n\n  <div class=\"table-responsive\">\n    <div class=\"text-context\">\n      <button class=\"btn btn-light\" onclick=\"boldText()\" type=\"button\" name=\"boldButton\"><b>B</b></button>\n      <button class=\"btn btn-light\" onclick=\"italicText()\" type=\"button\"><b>I</strong></b></button>\n      <button class=\"btn btn-light\" onclick=\"underlineText()\" type=\"button\"><b>U</strong></b></button>\n      <button class=\"btn btn-light\" onclick=\"justifyLeft()\" type=\"button\"><i class=\"fas fa-align-left\"></i></button>\n      <button class=\"btn btn-light\" onclick=\"justifyCenter()\" type=\"button\"><i class=\"fas fa-align-center\"></i></button>\n      <button class=\"btn btn-light\" onclick=\"justifyRight()\" type=\"button\"><i class=\"fas fa-align-right\"></i></button>\n\n\n    </div>\n\n    <header class=\" p-4 text-center\">\n      Schedule\n    </header>\n    <div class=\"dropdown font-color-menu\">\n      <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuFont\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <i class=\"fas fa-palette\"></i>\n      </button>\n      <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuFont\">\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#d62c2c')\">Red</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#395bad')\">Blue</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#39ad3b')\">Green</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#000')\">Black</button>\n      </div>\n    </div>\n    <div class=\"dropdown color-menu\">\n      <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuHighlight\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <i class=\"fas fa-highlighter\"></i>\n      </button>\n      <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuHighlight\">\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#ed564b')\">Red</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#aaafad')\">Gray</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#efe51c')\">Yellow</button>\n      </div>\n    </div>\n    <div class=\"container-fluid\">\n      <div class=\"dropdown cell-color-menu\">\n        <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuCell\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n          <i class=\"fas fa-table\"></i>\n        </button>\n        <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuCell\">\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#d61313')\">Red</button>\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#595959')\">Gray</button>\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#ffcd39')\">Yellow</button>\n            <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#fff')\">White</button>\n        </div>\n      </div>\n      <div class=\"container-fluid\">\n\n    <div class=\"container-fluid\">\n\n        <table class=\"table table-condensed table-sm table-bordered table-hover schedule-table\">\n\n          <tbody>\n            <tr class=\"row_0\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            <tr class=\"row_1\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            </tr>\n            <tr class=\"row_2\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            </tr>\n            <tr class=\"row_3\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>4\n              <td class=\"col_8\"></td>\n            </tr>\n            </tr>\n            <tr class=\"row_4\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            </tr>\n            <tr class=\"row_5\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            <tr class=\"row_6\">\n              <td class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n              <td class=\"col_1\"></td>\n              <td class=\"col_2\"></td>\n              <td class=\"col_3\"></td>\n              <td class=\"col_4\"></td>\n              <td class=\"col_5\"></td>\n              <td class=\"col_6\"></td>\n              <td class=\"col_7\"></td>\n              <td class=\"col_8\"></td>\n            </tr>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n\n    </div>\n\n\n    <script type=\"text/javascript\">\n      \n\nvar table = document.querySelector(\".schedule-table tbody\");\nvar tableData = document.querySelectorAll(\"td\");\nvar rows = table.querySelectorAll(\"tr\");\nvar colClassNum, currentRowNum;\nvar currentTarget;\n\n\nfor(var i = 0; i < tableData.length; i++){\n\n    tableData[i].contentEditable = \"true\";\n}\n//add columns\n\n\n\n\nfunction addColumnEnd(){\n\n\n//handle inputs\n var rows = document.querySelectorAll(\".schedule-table tbody tr\");\n var rowstoArray = Array.from(rows);\n\n\nrowstoArray.forEach(function(element){\n      var newdata =   document.createElement(\"td\");\n       newdata.contentEditable = \"true\";\n       newdata.classList.add(\"col_\" + colClassNum);\n       element.appendChild(newdata);\n       refactorColNums();\n\n});\n\n}\n\nfunction addColumnRight(){\n\n\n//handle inputs\n var rows = document.querySelectorAll(\".col_\" + colClassNum);\n var rowstoArray = Array.from(rows);\n\n\nrowstoArray.forEach(function(element){\n      var newdata =   document.createElement(\"td\");\n      newdata.contentEditable = \"true\";\n      newdata.classList.add(\"col\" + (colClassNum+1));\n    element.after(newdata);\n    refactorColNums();\n});\n//TODO cycle through remaining classes and change column number\n\n}\n\n\nfunction addColumnLeft(){\n\n\n//handle inputs\n var column = document.querySelectorAll(\".col_\" + colClassNum);\n var columntoArray = Array.from(column);\n\n\ncolumntoArray.forEach(function(element){\n      var newdata =   document.createElement(\"td\");\n      newdata.contentEditable = \"true\";\n      newdata.classList.add(\"col\" + (colClassNum-1));\n    element.before(newdata);\n\n});\nrefactorColNums();\n  //TODO cycle through remaining classes and change column number\n\n}\n\n\n\n\nfunction removeColumnEnd(){\n\n var rows = document.querySelectorAll(\".schedule-table tbody tr\");\n var rowstoArray = Array.from(rows);\n\n\nrowstoArray.forEach(function(element){\n  console.log(element.lastElementChild);\n    element.removeChild(element.lastElementChild);\n});\n\n}\n\nfunction removeColumn(){\n\n var rows = document.querySelectorAll(\".schedule-table tbody tr\");\n var rowstoArray = Array.from(rows);\n\n\nrowstoArray.forEach(function(element){\n\n    var rowChildren = element.childNodes;\n    for(var i = 0; i < rowChildren.length; i++){\n      if(rowChildren[i].nodeType === 1){\n        var classStr = rowChildren[i].classList;\n\n        if(classStr.contains(\"col_\" + colClassNum)){\n          rowChildren[i].remove();\n         }\n      }\n\n    }\n    refactorColNums();\n\n    console.log(rowChildren);\n\n});\n\n}\n\n\n\n\n\nfunction addRowBelow(){\n  var newRow = document.createElement(\"tr\");\n  newRow.classList.add(\"row_\"+(currentRowNum+1));\n  var currentRow = document.querySelector(\"tr\");\n  var currentRowChildren = currentRow.childNodes;\n  for(var i = 0; i < currentRowChildren.length; i++){\n      if(currentRowChildren[i].nodeType === 1){\n        var newTd = document.createElement(\"td\");\n        newTd.contentEditable = \"true\";\n        newTd.classList.add(\"col_\" + i);\n        newRow.appendChild(newTd);\n      }\n\n\n  }\n  var targetRow = document.querySelector(\".row_\" + currentRowNum);\n  targetRow.after(newRow);\n  refactorRowNums();\n\n\n}\n\nfunction addRowAbove(){\n  var newRow = document.createElement(\"tr\");\n  newRow.classList.add(\"row_\"+(currentRowNum-1));\n  var currentRow = document.querySelector(\"tr\");\n  var currentRowChildren = currentRow.childNodes;\n  for(var i = 0; i < currentRowChildren.length; i++){\n      if(currentRowChildren[i].nodeType === 1){\n        var newTd = document.createElement(\"td\");\n        newTd.contentEditable = \"true\";\n        newTd.classList.add(\"col_\" + i);\n        newRow.appendChild(newTd);\n      }\n\n\n  }\n  var targetRow = document.querySelector(\".row_\" + currentRowNum);\n  targetRow.before(newRow);\n  refactorRowNums();\n\n}\n\nfunction removeRow(){\n    var delRowTarget = document.querySelector(\".row_\"+ currentRowNum);\n    delRowTarget.remove();\n    refactorRowNums();\n\n}\n\n\n\n\n\n\n\nfunction refactorColNums(){\n\n  var dataCount = 0;\n\n //handle inputs\n  var rows = document.querySelectorAll(\".schedule-table tbody tr\");\n  var rowstoArray = Array.from(rows);\n\n  rowstoArray.forEach(function(element){\n    var rowData = element.childNodes;\n    dataCount = 0; //keep track of data class numbers\n\n        //node list for each loop won't work and used i to calculate new col numbers\n        for(var i = 0; i < rowData.length; i++){\n          if(rowData[i].nodeType === 1){\n            rowData[i].classList.replace(rowData[i].classList,\"col_\" + dataCount);\n            dataCount++;\n\n          }\n        }\n\n    });\n}\n\nfunction refactorRowNums(){\n var rows = document.querySelectorAll(\"tr\");\n var rowsLength = rows.length;\n for(var i = 0; i < rowsLength; i++){\n   if(rows[i].nodeType === 1){ //make sure node is an element\n        rows[i].classList.replace(rows[i].classList, \"row_\" + i);\n   }\n\n }\n}\n\n//hides menu onclick if dropdown is open\ndocument.querySelector(\".schedule-table\").addEventListener(\"click\", function(e){\n  document.querySelector(\".hidden-menu\").classList.add(\"hide\");\n  var currentCol = e.target.className; //column\n  colClassNum = parseInt(currentCol.slice(4));\n  var currentRowStr = e.target.parentNode.className; //row\n  currentRowNum = parseInt(currentRowStr.slice(4));\n  currentTarget = e.target;\n});\n\nif (document.addEventListener) { // IE >= 9; other browsers\n    document.querySelector(\".schedule-table\").addEventListener('contextmenu', function(e) {\n        document.querySelector(\".drop-menu-div\").classList.add(\"show\");\n        document.querySelector(\".hidden-menu\").classList.remove(\"hide\");\n        document.querySelector(\".drop-menu-div\").style.top =  e.pageY + 'px';\n        document.querySelector(\".drop-menu-div\").style.left = e.pageX + 'px';\n        var currentCol = e.target.className; //column\n        colClassNum = parseInt(currentCol.slice(4));\n        var currentRowStr = e.target.parentNode.className; //row\n        currentRowNum = parseInt(currentRowStr.slice(4));\n        currentTarget = e.target;\n        //console.log(currentColNum);\n        e.preventDefault();\n\n\n    }, false); // bubbles which is default anyway\n} else { // IE < 9\n    document.querySelector(\".schedule-table\").attachEvent('oncontextmenu', function() {\n        alert(\"You've tried to open context menu\");\n        window.event.returnValue = false;\n    });\n}\n\ndocument.addEventListener(\"keydown\", function(e){\n  var currentCol = e.target.className; //column\n  colClassNum = parseInt(currentCol.slice(4));\n  var currentRowStr = e.target.parentNode.className; //row\n  currentRowNum = parseInt(currentRowStr.slice(4));\n\n  console.log(e.keyCode);\n\n\n  var tablerow = document.querySelectorAll(\"tr\");\n  var tableColumn = document.querySelector(\".row_0\").children;\n\n  if(e.keyCode === 38){\n    if(currentRowNum > 0){\n      currentTarget = document.querySelector(\".row_\" + (currentRowNum-1) + \" .col_\" + colClassNum);\n      currentTarget.focus();\n    }\n\n\n  }\n  //down arrow\n  if(e.keyCode === 40){\n    if(currentRowNum < (tablerow.length -1)){\n        currentTarget = document.querySelector(\".row_\" + (currentRowNum+1) + \" .col_\" + colClassNum);\n        currentTarget.focus();\n    }\n\n  }\n  //left arrow\n  if(e.keyCode === 37){\n    if(colClassNum > 0){\n      currentTarget = document.querySelector(\".row_\" + (currentRowNum) + \" .col_\" + (colClassNum-1));\n      currentTarget.focus();\n    }\n\n  }\n  //right arrow\n  if(e.keyCode === 39){\n    if(colClassNum < (tableColumn.length -1)){\n          currentTarget = document.querySelector(\".row_\" + (currentRowNum) + \" .col_\" + (colClassNum+1));\n          currentTarget.focus();\n\n    }\n\n  }\n  //b for bold text\n\n  if(e.ctrlKey && e.keyCode === 66){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('bold');\n  }\n  if(e.ctrlKey && e.keyCode === 73){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('italic');\n  }\n  if(e.ctrlKey && e.keyCode === 85){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('underline');\n  }\n  if(e.shiftKey && e.keyCode === 69){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyCenter',true,null);\n  }\n  if(e.shiftKey && e.keyCode === 76){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyLeft',false,null);\n  }\n  if(e.shiftKey && e.keyCode === 82){\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyRight',true,null);\n  }\n\n});\n\n\nfunction boldText(){\n   document.execCommand('bold');\n   currentTarget.focus();\n}\nfunction italicText(){\n   document.execCommand('italic');\n   currentTarget.focus();\n}\nfunction underlineText(){\n   document.execCommand('underline');\n   currentTarget.focus();\n}\nfunction justifyRight(){\n    document.execCommand('justifyRight');\n   currentTarget.focus();\n}\nfunction justifyLeft(){\n   document.execCommand('justifyLeft');\n   currentTarget.focus();\n}\nfunction justifyCenter(){\n   document.execCommand('justifyCenter');\n   currentTarget.focus();\n}\n\nfunction setHighlightColor(highColor){\n  currentTarget.focus();\n   document.execCommand('hilitecolor',false,highColor);\n}\nfunction setfontColor(fontColor){\n  currentTarget.focus();\n   document.execCommand('foreColor',false,fontColor);\n\n}\n\n\nfunction setCellColor(bgcolor){\n  currentTarget.focus();\n   currentTarget.style.backgroundColor = bgcolor;\n}\n\n\n</script>\n\n    <script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\" integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\" integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\" integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\" crossorigin=\"anonymous\"></script>\n  \n\n\n    \n<% include ./partials/footer %>","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":116,"column":37},"end":{"row":116,"column":38},"action":"insert","lines":["4"],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":172,"column":0},"end":{"row":172,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1551859743263}