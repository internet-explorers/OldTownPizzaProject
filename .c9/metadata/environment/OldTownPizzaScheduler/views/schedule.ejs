{"changed":true,"filter":false,"title":"schedule.ejs","tooltip":"/OldTownPizzaScheduler/views/schedule.ejs","value":"<% include ./partials/headIsUser%>\n\n  <!--dropdown menu  -->\n  <div class=\"dropdown hide hidden-menu\">\n    <div class=\"dropdown-menu drop-menu-div\">\n      <a class=\"dropdown-item\" onclick=\"addRowAbove()\">Add Row Above</a>\n      <a class=\"dropdown-item\" onclick=\"addRowBelow()\">Add Row Below</a>\n      <a class=\"dropdown-item\" onclick=\"removeRow()\">Remove Row</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnRight()\">Add Column Right</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnLeft()\">Add Column Left</a>\n      <a class=\"dropdown-item\" onclick=\"addColumnEnd()\">Add Column to End</a>\n      <a class=\"dropdown-item\" onclick=\"removeColumn()\">Remove Column</a>\n    </div>\n  </div>\n\n\n\n\n  <div class=\"table-responsive text-modifier\">\n    <div class=\"text-context text-modifier\">\n      <button class=\"btn btn-light\" onclick=\"boldText()\" type=\"button\" name=\"boldButton\"><b>B</b></button>\n      <button class=\"btn btn-light\" onclick=\"italicText()\" type=\"button\"><b>I</strong></b></button>\n      <button class=\"btn btn-light\" onclick=\"underlineText()\" type=\"button\"><b>U</strong></b></button>\n      <button class=\"btn btn-light\" onclick=\"justifyLeft()\" type=\"button\"><i class=\"fas fa-align-left\"></i></button>\n      <button class=\"btn btn-light\" onclick=\"justifyCenter()\" type=\"button\"><i class=\"fas fa-align-center\"></i></button>\n      <button class=\"btn btn-light\" onclick=\"justifyRight()\" type=\"button\"><i class=\"fas fa-align-right\"></i></button>\n\n\n    </div>\n\n\n    <div class=\"dropdown font-color-menu text-modifier\">\n      <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenu2\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <i class=\"fas fa-palette\"></i>\n      </button>\n      <div class=\"dropdown-menu text-modifier\" aria-labelledby=\"dropdownMenu2\">\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#d62c2c')\">Red</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#395bad')\">Blue</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#39ad3b')\">Green</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setfontColor('#000')\">Black</button>\n      </div>\n    </div>\n    <div class=\"dropdown color-menu text-modifier\">\n      <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenu2\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <i class=\"fas fa-highlighter\"></i>\n      </button>\n      <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenu2\">\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#ed564b')\">Red</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#aaafad')\">Gray</button>\n        <button class=\"dropdown-item\" type=\"button\" onclick=\"setHighlightColor('#efe51c')\">Yellow</button>\n      </div>\n    </div>\n    <div class=\"container-fluid\">\n      <div class=\"dropdown cell-color-menu text-modifier\">\n        <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenu2\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n          <i class=\"fas fa-table\"></i>\n        </button>\n        <div class=\"dropdown-menu text-modifier\" aria-labelledby=\"dropdownMenu2\">\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#d61313')\">Red</button>\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#595959')\">Gray</button>\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#ffcd39')\">Yellow</button>\n          <button class=\"dropdown-item\" type=\"button\" onclick=\"setCellColor('#fff')\">White</button>\n        </div>\n      </div>\n      <div id=\"tableControls\" class=\"carousel slide\" data-ride=\"carousel\" data-interval=\"false\" data-keyboard=\"false\">\n        <div class=\"container-fluid\">\n\n          <div class=\"container-fluid\">\n\n            <div class=\"carousel-inner\">\n              <div class=\"carousel-item active\">\n                <form class=\"table-submit-form\" action=\"/\" method=\"post\">\n                  <header class=\" p-4 text-center\">\n                    <input class=\"form-control schedule-title\" type=\"text\" name=\"schedule_title\" placeholder=\"Title\" value=\"<%=thisMonthStr%> <%=thisYearStr%>: <%=datesThisWeek[0]%>-<%=datesThisWeek[6]%> \">\n                  </header>\n\n                  <table name=\"schedule\" class=\"table table-condensed table-sm table-bordered table-hover schedule-table\">\n\n                    <tbody>\n\n\n                      <tr class=\"row_0\">\n                        <td name=\"A\" class=\"col_header col_0\" contenteditable=\"true\" scope=\"row\"><b>ID</b></td>\n                        <td name=\"B\" class=\"col_header col_1\"><b>Name</b></td>\n                        <td name=\"C\" class=\"col_header col_2\"><b>Phone</b></td>\n                        <td name=\"D \" class=\"col_header col_3\"><b>Position</b></td>\n                        <td name=\"E\" class=\"col_header col_4\"><b>Monday<br>\n                            <%=datesThisWeek[0]%></b></td>\n                        <td name=\"F\" class=\"col_header col_5\"><b>Tuesday<br>\n                            <%=datesThisWeek[1]%></b></td>\n                        <td name=\"G\" class=\"col_header col_6\"><b>Wednesday<br>\n                            <%=datesThisWeek[2]%></b></td>\n                        <td name=\"H\" class=\"col_header col_7 \"><b>Thursday<br>\n                            <%=datesThisWeek[3]%></b></td>\n                        <td name=\"I\" class=\"col_header col_8\"><b>Friday<br>\n                            <%=datesThisWeek[4]%></b></td>\n                        <td name=\"J\" class=\"col_header col_9\"><b>Saturday<br>\n                            <%=datesThisWeek[5]%></b></td>\n                        <td name=\"K\" class=\"col_header col_10\"><b>Sunday<br>\n                            <%=datesThisWeek[6]%></b></td>\n\n                      </tr>\n                      <tr class=\"row_1\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <tr class=\"row_2\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <tr class=\"row_3\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <tr class=\"row_4\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <tr class=\"row_5\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <tr class=\"row_6\" value=\"hello\">\n                        <td name=\"A\" class=\"col_0\" contenteditable=\"true\" scope=\"row\"></td>\n                        <td name=\"B\" class=\"col_1\"></td>\n                        <td name=\"C\" class=\"col_2\"></td>\n                        <td name=\"D \" class=\"col_3\"></td>\n                        <td name=\"E\" class=\"col_4\"></td>\n                        <td name=\"F\" class=\"col_5\"></td>\n                        <td name=\"G\" class=\"col_6\"></td>\n                        <td name=\"H\" class=\"col_7\"></td>\n                        <td name=\"I\" class=\"col_8\"></td>\n                        <td name=\"J\" class=\"col_9\"></td>\n                        <td name=\"K\" class=\"col_10\"></td>\n\n                      </tr>\n                      <!-- <input type=\"hidden\" name=\"r0\" value=\"\">\n                <input type=\"hidden\" name=\"r1\" value=\"\">\n                <input type=\"hidden\" name=\"r2\" value=\"\">\n                <input type=\"hidden\" name=\"r3\" value= \"\">\n                <input type=\"hidden\" name=\"r4\" value=\"\">\n                <input type=\"hidden\" name=\"r5\" value=\"\">\n                <input type=\"hidden\" name=\"r6\"> -->\n                    </tbody>\n                  </table>\n                  <button class=\"btn btn-success publish-schedule-button\" type=\"button\" name=\"button\" onclick=\"getTableContent()\">Publish</button>\n                  <button class=\"btn btn-primary\" type=\"button\" name=\"button\" onclick=\"addSchedule()\" data-target=\"#tableControls\">New Schedule</button>\n                  <button class=\"btn btn-danger\" type=\"button\" name=\"deletebutton\" data-target=\"#tableControls\" data-slide=\"prev\" onclick=\"\" >Delete Schedule</button>\n                  <input type=\"hidden\" name=\"ArrayDate\" class=\"inputDate\"value=\"\">\n                </form>\n              </div>\n\n\n\n\n            </div>\n            <a class=\"carousel-control-prev btn-secondary\" href=\"#tableControls\" role=\"button\" data-slide=\"prev\">\n              <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n              <span class=\"sr-only\">Previous</span>\n            </a>\n            <a class=\"carousel-control-next btn-secondary\" href=\"#tableControls\" role=\"button\" data-slide=\"next\">\n              <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\n              <span class=\"sr-only\">Next</span>\n            </a>\n          </div>\n\n\n        </div>\n      </div>\n\n\n\n\n\n\n    <script type=\"text/javascript\">\nvar table = document.querySelector(\".schedule-table tbody\");\nvar tableData = document.querySelectorAll(\"td\");\nvar rows = table.querySelectorAll(\"tr\");\nvar colClassNum, currentRowNum;\nvar currentTarget;\nvar currentSchedule = document.querySelector(\".carousel-item.active\")\nvar schedules = [];\nif (schedules.length === 0) {\n    let loadedSchedules = document.querySelectorAll(\".carousel-item\");\n    for(let i = 0; i < loadedSchedules.length; i++){\n        schedules.push(loadedSchedules[i]);\n    }\n\n}\n//TODO: refactor RowNames upon row creation and row delection\n\nfor (var i = 0; i < tableData.length; i++) {\n\n  tableData[i].contentEditable = \"true\";\n}\n//add columns\n\n\n\n\nfunction addColumnEnd() {\n\n\n  //handle inputs\n  var rows = currentSchedule.querySelectorAll(\".schedule-table tbody tr\");\n  var rowstoArray = Array.from(rows);\n\n\n  rowstoArray.forEach(function(element) {\n    var newdata = document.createElement(\"td\");\n    newdata.contentEditable = \"true\";\n    element.appendChild(newdata);\n\n  });\n\n}\n\nfunction addColumnRight() {\n\n\n  //handle inputs\n  var rows = currentSchedule.querySelector(\".schedule-table\").rows;\n  //console.log(rows);\n  var rowstoArray = Array.from(rows);\n\n  var selectedColumns = [];\n\n  rowstoArray.forEach(function(element) {\n    selectedColumns.push(element.cells[colClassNum]);\n\n  });\n  selectedColumns.forEach(function(element) {\n    var newdata = document.createElement(\"td\");\n    newdata.contentEditable = \"true\";\n    element.after(newdata);\n  });\n  //TODO cycle through remaining classes and change column number\n\n}\n\n\nfunction addColumnLeft() {\n\n  var rows = currentSchedule.querySelector(\".schedule-table\").rows;\n  //console.log(rows);\n  var rowstoArray = Array.from(rows);\n\n  var selectedColumns = [];\n\n  rowstoArray.forEach(function(element) {\n    selectedColumns.push(element.cells[colClassNum]);\n\n  });\n  selectedColumns.forEach(function(element) {\n    var newdata = document.createElement(\"td\");\n    newdata.contentEditable = \"true\";\n    element.before(newdata);\n  });\n\n}\n\n\n\n\nfunction removeColumnEnd() {\n\n  var rows = currentSchedule.querySelectorAll(\".schedule-table tbody tr\");\n  var rowstoArray = Array.from(rows);\n\n\n  rowstoArray.forEach(function(element) {\n    element.removeChild(element.lastElementChild);\n  });\n\n}\n\nfunction removeColumn() {\n\n  var rows = currentSchedule.querySelector(\".schedule-table\").rows;\n  var rowstoArray = Array.from(rows);\n\n\n  rowstoArray.forEach(function(element) {\n\n    var rowChildren = element.childNodes;\n    var i = 0;\n    var nodeCount = 0;\n    while (i < rowChildren.length) {\n      if (rowChildren[i].nodeType === 1) { //make sure nodetype is td, not text\n        // var classStr = rowChildren[i].classList;\n\n\n        if (rowChildren[i].cellIndex === colClassNum) {\n          console.log(i);\n          //console.log(rowChildren[i].cellIndex);\n          rowChildren[i].remove();\n          break;\n        }\n      }\n      i++;\n    }\n\n  });\n  //refactorColNums();\n\n\n}\n\n\n\n\n\nfunction addRowBelow() {\n  var newRow = document.createElement(\"tr\");\n\n  //newRow.classList.add(\"row_\" + (currentRowNum + 1));\n  var currentRow = currentSchedule.querySelector(\"tr\"); //row length\n  var currentRowChildren = currentRow.childNodes;\n  for (var i = 0; i < currentRowChildren.length; i++) {\n    if (currentRowChildren[i].nodeType === 1) {\n      var newTd = document.createElement(\"td\");\n      newTd.contentEditable = \"true\";\n      // newTd.classList.add(\"col_\" + i);\n      newRow.appendChild(newTd);\n    }\n\n\n  }\n\n  var targetRow = currentSchedule.querySelector(\".schedule-table\").rows[currentRowNum]\n  targetRow.after(newRow);\n  refactorRowNames();\n\n\n}\n\nfunction addRowAbove() {\n  var newRow = document.createElement(\"tr\");\n  // newRow.classList.add(\"row_\" + (currentRowNum - 1));\n  var currentRow = currentSchedule.querySelector(\"tr\");\n  var currentRowChildren = currentRow.childNodes;\n  for (var i = 0; i < currentRowChildren.length; i++) {\n    if (currentRowChildren[i].nodeType === 1) {\n      var newTd = document.createElement(\"td\");\n      newTd.contentEditable = \"true\";\n      // newTd.classList.add(\"col_\" + i);\n      newRow.appendChild(newTd);\n    }\n\n\n  }\n  var targetRow = currentSchedule.querySelector(\".schedule-table\").rows[currentRowNum]\n  targetRow.before(newRow);\n  refactorRowNames();\n\n}\n\nfunction removeRow() {\n  var delRowTarget = currentSchedule.querySelector(\".schedule-table\").rows[currentRowNum]\n  delRowTarget.remove();\n  refactorRowNames();\n\n}\n\n\n\n\n\n\n\nfunction refactorColNums() {\n\n  var dataCount = 0;\n\n  //handle inputs\n  var rows = currentSchedule.querySelectorAll(\".schedule-table tbody tr\");\n  var rowstoArray = Array.from(rows);\n\n  rowstoArray.forEach(function(element) {\n    var rowData = element.childNodes;\n    dataCount = 0; //keep track of data class numbers\n\n    //node list for each loop won't work and used i to calculate new col numbers\n    for (var i = 0; i < rowData.length; i++) {\n      if (rowData[i].nodeType === 1) {\n        rowData[i].classList.replace(rowData[i].classList, \"col_\" + dataCount);\n        dataCount++;\n\n      }\n    }\n\n  });\n}\n\nfunction refactorRowNames() {\n  var rows = currentSchedule.querySelectorAll(\"tr\");\n  var rowsLength = rows.length;\n  for (var i = 0; i < rowsLength; i++) {\n    if (rows[i].nodeType === 1) { //make sure node is an element\n      // rows[i].classList.replace(rows[i].classList, \"row_\" + i);\n      rows[i].setAttribute(\"name\", i);\n    }\n\n  }\n}\n\n//hides menu onclick if dropdown is open\nlet loadedSchedules = document.querySelectorAll(\".schedule-table\");\nlet loadedSchedulesArray = Array.from(loadedSchedules);\nloadedSchedulesArray.forEach(function(schedule) {\n  schedule.addEventListener(\"click\", function(e) {\n    document.querySelector(\".hidden-menu\").classList.add(\"hide\");\n    var currentCol = e.target; //column\n    colClassNum = currentCol.cellIndex;\n    var currentRowStr = e.target.parentNode; //row\n    currentRowNum = currentRowStr.rowIndex;\n    currentTarget = e.target;\n    currentSchedule = (e.target.parentNode.parentNode.parentNode.parentNode.parentNode);\n\n  });\n});\n\nif (document.addEventListener) { // IE >= 9; other browsers\n\n  let loadedSchedules = document.querySelectorAll(\".carousel-item\");\n  let loadedSchedulesArray = Array.from(loadedSchedules);\n  loadedSchedulesArray.forEach(function(shedule) {\n    shedule.querySelector(\"table\").addEventListener('contextmenu', function(e) {\n      // document.querySelector(\".schedule-table\").addEventListener('contextmenu', function(e) {\n      document.querySelector(\".drop-menu-div\").classList.add(\"show\");\n      document.querySelector(\".hidden-menu\").classList.remove(\"hide\");\n      document.querySelector(\".drop-menu-div\").style.top = e.pageY + 'px';\n      document.querySelector(\".drop-menu-div\").style.left = e.pageX + 'px';\n      var currentCol = e.target; //column\n      colClassNum = currentCol.cellIndex;\n\n      var currentRowStr = e.target.parentNode; //row\n      currentRowNum = currentRowStr.rowIndex;\n      currentTarget = e.target;\n      currentSchedule = (e.target.parentNode.parentNode.parentNode.parentNode.parentNode);\n      //console.log(currentColNum);\n      e.preventDefault();\n\n\n    }, false); // bubbles which is default anyway\n  });\n} else { // IE < 9\n  document.querySelector(\".schedule-table\").attachEvent('oncontextmenu', function() {\n    alert(\"You've tried to open context menu\");\n    window.event.returnValue = false;\n  });\n}\n\n\ndocument.querySelector(\".schedule-table\").addEventListener(\"keydown\", function(e) {\n  var currentCol = e.target; //column\n  colClassNum = currentCol.cellIndex;\n  var currentRowStr = e.target.parentNode; //row\n  currentRowNum = currentRowStr.rowIndex;\n\n  // console.log(e.keyCode);\n\n\n  var tablerow = document.querySelectorAll(\"tr\");\n  var tableColumn = document.querySelector(\".row_0\").children;\n\n  //up arrow\n  if (e.keyCode === 38) {\n    if (currentRowNum > 0) {\n      // currentTarget = document.querySelector(\".row_\" + (currentRowNum - 1) + \" .col_\" + colClassNum);\n      currentTarget = document.querySelector(\".schedule-table\").rows[currentRowNum - 1].cells[colClassNum];\n      currentTarget.focus();\n    }\n\n\n  }\n  //down arrow\n  if (e.keyCode === 40) {\n    if (currentRowNum < (tablerow.length - 1)) {\n      currentTarget = document.querySelector(\".schedule-table\").rows[currentRowNum + 1].cells[colClassNum];\n      currentTarget.focus();\n    }\n\n  }\n  //left arrow\n  if (e.keyCode === 37) {\n    if (colClassNum > 0) {\n      currentTarget = document.querySelector(\".schedule-table\").rows[currentRowNum].cells[colClassNum - 1];\n      currentTarget.focus();\n    }\n\n  }\n  //right arrow\n  if (e.keyCode === 39) {\n    if (colClassNum < (tableColumn.length - 1)) {\n      currentTarget = document.querySelector(\".schedule-table\").rows[currentRowNum].cells[colClassNum + 1];\n      currentTarget.focus();\n\n    }\n\n  }\n  //b for bold text\n\n  if (e.ctrlKey && e.keyCode === 66) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('bold');\n  }\n  if (e.ctrlKey && e.keyCode === 73) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('italic');\n  }\n  if (e.ctrlKey && e.keyCode === 85) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('underline');\n  }\n  if (e.shiftKey && e.keyCode === 69) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyCenter', true, null);\n  }\n  if (e.shiftKey && e.keyCode === 76) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyLeft', false, null);\n  }\n  if (e.shiftKey && e.keyCode === 82) {\n    e.preventDefault();\n    e.stopPropagation();\n    document.execCommand('justifyRight', true, null);\n  }\n\n});\n\n\nfunction boldText() {\n  document.execCommand('bold');\n  currentTarget.focus();\n}\n\nfunction italicText() {\n  document.execCommand('italic');\n  currentTarget.focus();\n}\n\nfunction underlineText() {\n  document.execCommand('underline');\n  currentTarget.focus();\n}\n\nfunction justifyRight() {\n  document.execCommand('justifyRight');\n  currentTarget.focus();\n}\n\nfunction justifyLeft() {\n  document.execCommand('justifyLeft');\n  currentTarget.focus();\n}\n\nfunction justifyCenter() {\n  document.execCommand('justifyCenter');\n  currentTarget.focus();\n}\n\nfunction setHighlightColor(highColor) {\n  currentTarget.focus();\n  document.execCommand('hilitecolor', false, highColor);\n}\n\nfunction setfontColor(fontColor) {\n  currentTarget.focus();\n  document.execCommand('foreColor', false, fontColor);\n\n}\n\n\nfunction setCellColor(bgcolor) {\n  currentTarget.focus();\n  currentTarget.style.backgroundColor = bgcolor;\n}\n\n//get data from table\nfunction getTableContent() {\n  let rowObjects = []; //empty array for objects\n  //get rows\\\n  let rows = currentSchedule.querySelector(\".schedule-table\").rows;\n  let rowsToArray = Array.from(rows);\n  let numberOfRows = 0;\n  let form;\n  var carouselDiv = document.createElement(\"div\");\n  carouselDiv.classList.add(\"Place-holder-div\");\n  carouselDiv.appendChild(currentSchedule);\n\n  rowsToArray.forEach(function(row) {\n\n    let rowtextData = [] //array for text data\n    for (let i = 0; i < (row.children.length); i++) {\n      rowtextData.push(row.children[i].textContent);\n\n    }\n    //console.log(document.querySelector())\n    rowObjects.push(rowtextData);\n    numberOfRows++;\n\n\n  });\n  var htmlInput = document.createElement(\"input\");\n  htmlInput.type = \"hidden\";\n  htmlInput.value = carouselDiv.innerHTML;\n  console.log(carouselDiv.innerHTML);\n  htmlInput.name = \"htmlCode\";\n\n  for (let i = 0; i < rowObjects.length; i++) {\n    // let currentRowObject = document.getElementsByName(\"r\"+i);\n    // console.log(currentRowObject);\n    // currentRowObject[0].value = rowObjects[i];\n    //add input so that it can be used upon submission\n    var newRowInput = document.createElement(\"input\");\n    newRowInput.type = \"hidden\";\n    newRowInput.value = rowObjects[i];\n    newRowInput.name = (\"r\" + i);\n    form = carouselDiv.querySelector(\".table-submit-form\");\n    form.appendChild(newRowInput)\n\n  }\n  //create input that holds inner html for table\n\n  //scheduleTitle = document.querySelector(\".schedule-title\");\n  //console.log(scheduleTitle);\n  form = carouselDiv.querySelector(\".table-submit-form\");\n\n  form.appendChild(htmlInput);\n  form.classList.add(\"hide\");\n  document.body.appendChild(form);\n  console.log(htmlInput);\n\n  //document.getElementsByName(\"rowArrayLength\")[0].value = numberOfRows;\n  form.submit();\n\n}\n\n\n//loop through rows and assign each row a row object with cell text\n\n\n//   document.querySelector(\".schedule-table\").rows[0].cells[0].textContent\n//\n// }\n\nfunction addSchedule() {\n  let datesForWeek = getDatesForSchedule(); //get full form dates\n  console.log(datesForWeek);\n  //get previouse week dates\n  let datesThisWeek = []; //numeric dates\n  datesForWeek.forEach(function(day) {\n    datesThisWeek.push(day.slice(8));\n  });\n  let newTable = document.querySelector(\".carousel-item.active\").cloneNode(true);\n  if (newTable === null) {\n    tables = document.querySelectorAll(\".carousel-item\");\n    newTable = tables[tables.length - 1].cloneNode(true);\n  }\n  newTable.classList = \"carousel-item \" + datesForWeek[0]; // add carousell-item\n  newTable.querySelector(\".table-submit-form\").classList = \"table-submit-form table\" + datesForWeek[0] + \"-submit-from\" // change form submission, will need to change\n  newTable.querySelector(\"table\").classList = \"table table-condensed table-sm table-bordered table-hover schedule-table schedule-table-\" + datesForWeek[0];\n  newTable.querySelector(\".inputDate\").value = datesForWeek[0];\n\n  headerRow = newTable.querySelector(\".row_0\");\n  let tableDay = [\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"];\n  let mondayIndex, sundayIndex;\n\n\n  //get column with monday and sunday, so we know where to place dates in column\n  for (let i = 0; i < headerRow.children.length; i++) {\n\n    if (headerRow.children[i].innerHTML.includes(\"Monday\")) {\n      let monday = headerRow.children[i];\n      let mondayClass = monday.classList.toString();\n\n      mondayIndex = Number(mondayClass.slice(15));\n    }\n    if (headerRow.children[i].innerHTML.includes(\"Sunday\")) {\n      let sunday = headerRow.children[i];\n      let sundayClass = sunday.classList.toString();\n\n      sundayIndex = Number(sundayClass.slice(15));\n    }\n  }\n  //gets dates for title\n  year = Number(datesForWeek[0].slice(0, 4));\n  month = Number(datesForWeek[0].slice(5, 7));\n  firstDay = Number(datesForWeek[0].slice(8, 10));\n  lastDay = Number(datesForWeek[6].slice(8, 10));\n  var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n  console.log(year, month, firstDay, lastDay);\n  var tempDate = new Date();\n  tempDate.setMonth(month - 1);\n  tempDate.setFullYear(year);\n  tempDate.setDate(firstDay);\n  var thisMonthStr = monthNames[tempDate.getMonth()];\n  console.log(tempDate.getMonth());\n  for (let i = mondayIndex; i <= sundayIndex; i++) {\n    headerRow.children[i].innerHTML = \"<b>\" + tableDay[i - 4] + \"</br>\" + datesThisWeek[i - 4] + \"</b>\";\n  }\n  //create title\n  newTable.querySelector(\".schedule-title\").value = thisMonthStr + \" \" + year + \": \" + datesThisWeek[0] + \"-\" + datesThisWeek[6]; //monday through sunday\n\n  document.querySelector(\".carousel-inner\").appendChild(newTable);\n  schedules.push(newTable);\n  addListeners(newTable);\n  currentSchedule = schedules[schedules.length - 1];\n  currentSchedule.querySelector(\".schedule-title\").setAttribute(\"value\",thisMonthStr + \" \" + year + \": \" + datesThisWeek[0] + \"-\" + datesThisWeek[6]);\n  $(\"#tableControls\").carousel(schedules.length - 1); // only way to use property carousel is in jquery\n  console.log(currentSchedule);\n\n\n\n}\n\nfunction deleleSchedule() {\n  let currentScheduleIndex = schedules.indexOf(currentSchedule);\n  //schedules.splice(currentScheduleIndex, 1); //remove schedule from array\n  currentSchedule.remove();\n  // var NextElement = $carousel.find('.item').first();\n  // NextElement.addClass('active');\n  schedules[currentScheduleIndex - 1].classList.add(\".active\");\n  // console.log(currentSchedule);\n  // console.log(schedules);\n}\n\n\n\nfunction getDatesForSchedule() {\n  let tables = document.querySelectorAll(\".carousel-item\"); //gets both tableControl\n  let lastTable = tables[tables.length - 1];\n  let year, month, lastDay;\n\n  let curr = new Date;\n\n  let nextWeekDates = [];\n  let firstMonday;\n  let secondMonday;\n  let currentDateYyyyMmDd;\n\n  if (tables.length > 1) {\n    let lastScheduleDate = lastTable.classList.toString();\n    year = Number(lastScheduleDate.slice(14, 18));\n    month = Number(lastScheduleDate.slice(19, 21));\n    lastDay = Number(lastScheduleDate.slice(22, 24)); //sundat\n    console.log(year, month, lastDay);\n    curr.setFullYear(year);\n    curr.setMonth(month - 1);\n    curr.setDate(lastDay);\n    nextWeekDates = [];\n    firstMonday = curr.getDate() - curr.getDay() + 1;\n    secondMonday = firstMonday + 6;\n    currentDateYyyyMmDd = curr.toISOString().slice(0, 10);\n\n  } else {\n    nextWeekDates = [];\n    firstMonday = curr.getDate() - curr.getDay() + 1;\n    secondMonday = firstMonday + 6;\n    currentDateYyyyMmDd = curr.toISOString().slice(0, 10);\n  }\n\n\n\n\n\n  for (let i = 0; i <= 6; i++) {\n    //subtract current day of the week\n    secondMonday++;\n    let day = new Date(curr.setDate(secondMonday)).toISOString().slice(0, 10)\n    nextWeekDates.push(day)\n  }\n\n  return nextWeekDates;\n}\n\nfunction addListeners(obj) {\n  obj.querySelector(\"table\").addEventListener('contextmenu', function(e) {\n    // document.querySelector(\".schedule-table\").addEventListener('contextmenu', function(e) {\n    document.querySelector(\".drop-menu-div\").classList.add(\"show\");\n    document.querySelector(\".hidden-menu\").classList.remove(\"hide\");\n    document.querySelector(\".drop-menu-div\").style.top = e.pageY + 'px';\n    document.querySelector(\".drop-menu-div\").style.left = e.pageX + 'px';\n    var currentCol = e.target; //column\n    colClassNum = currentCol.cellIndex;\n\n    var currentRowStr = e.target.parentNode; //row\n    currentRowNum = currentRowStr.rowIndex;\n    currentTarget = e.target;\n    currentSchedule = obj //get current schedule\n    //console.log(currentColNum);\n    e.preventDefault();\n\n\n  }, false); // bubbles which is default anyway\n\n  obj.querySelector(\".schedule-table\").addEventListener(\"click\", function(e) {\n    document.querySelector(\".hidden-menu\").classList.add(\"hide\");\n    var currentCol = e.target; //column\n    colClassNum = currentCol.cellIndex;\n    var currentRowStr = e.target.parentNode; //row\n    currentRowNum = currentRowStr.rowIndex;\n    currentTarget = e.target;\n    console.log(e.target.parentNode.parentNode.parentNode.parentNode.parentNode);\n    currentSchedule = obj\n\n  });\n\n  obj.querySelector(\".schedule-table\").addEventListener(\"keydown\", function(e) {\n    var currentCol = e.target; //column\n    colClassNum = currentCol.cellIndex;\n    var currentRowStr = e.target.parentNode; //row\n    currentRowNum = currentRowStr.rowIndex;\n\n    // console.log(e.keyCode);\n\n\n    var tablerow = obj.querySelectorAll(\"tr\");\n    var tableColumn = obj.querySelector(\".row_0\").children;\n\n    //up arrow\n    if (e.keyCode === 38) {\n      if (currentRowNum > 0) {\n        // currentTarget = document.querySelector(\".row_\" + (currentRowNum - 1) + \" .col_\" + colClassNum);\n        currentTarget = obj.querySelector(\".schedule-table\").rows[currentRowNum - 1].cells[colClassNum];\n        currentTarget.focus();\n      }\n\n\n    }\n    //down arrow\n    if (e.keyCode === 40) {\n      if (currentRowNum < (tablerow.length - 1)) {\n        currentTarget = obj.querySelector(\".schedule-table\").rows[currentRowNum + 1].cells[colClassNum];\n        currentTarget.focus();\n      }\n\n    }\n    //left arrow\n    if (e.keyCode === 37) {\n      if (colClassNum > 0) {\n        currentTarget = obj.querySelector(\".schedule-table\").rows[currentRowNum].cells[colClassNum - 1];\n        currentTarget.focus();\n      }\n\n    }\n    //right arrow\n    if (e.keyCode === 39) {\n      if (colClassNum < (tableColumn.length - 1)) {\n        currentTarget = obj.querySelector(\".schedule-table\").rows[currentRowNum].cells[colClassNum + 1];\n        currentTarget.focus();\n\n      }\n\n    }\n    //b for bold text\n\n    if (e.ctrlKey && e.keyCode === 66) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('bold');\n    }\n    if (e.ctrlKey && e.keyCode === 73) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('italic');\n    }\n    if (e.ctrlKey && e.keyCode === 85) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('underline');\n    }\n    if (e.shiftKey && e.keyCode === 69) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('justifyCenter', true, null);\n    }\n    if (e.shiftKey && e.keyCode === 76) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('justifyLeft', false, null);\n    }\n    if (e.shiftKey && e.keyCode === 82) {\n      e.preventDefault();\n      e.stopPropagation();\n      document.execCommand('justifyRight', true, null);\n    }\n\n  });\n\n}\n\n\n</script>\n\n    <script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\" integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\" integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\" integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\" crossorigin=\"anonymous\"></script>\n  \n\n\n    \n<% include ./partials/footer %>","undoManager":{"mark":-2,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":3261,"scrollleft":0,"selection":{"start":{"row":295,"column":4},"end":{"row":295,"column":15},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":12,"state":"start","mode":"ace/mode/ejs"}},"timestamp":1553755378899}